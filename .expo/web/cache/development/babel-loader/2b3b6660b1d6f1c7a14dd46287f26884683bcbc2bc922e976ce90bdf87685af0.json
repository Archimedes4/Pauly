{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport { loginRequest } from \"../authConfig\";\nexport default function callMsGraph(_x, _x2, _x3, _x4, _x5, _x6, _x7, _x8) {\n  return _callMsGraph.apply(this, arguments);\n}\nfunction _callMsGraph() {\n  _callMsGraph = _asyncToGenerator(function* (accessToken, url, instance, accounts, method, perfer, body, secondAuth) {\n    var headers = new Headers();\n    var bearer = `Bearer ${accessToken}`;\n    headers.append(\"Authorization\", bearer);\n    headers.append(\"Content-Type\", \"application/json\");\n    if (perfer) {\n      headers.append('Prefer', 'outlook.timezone=\"Central America Standard Time\"');\n    }\n    var options = {\n      method: method ? method : \"GET\",\n      headers: headers,\n      body: body\n    };\n    var response = yield fetch(url, options);\n    if (response.status === 401) {\n      if (secondAuth === undefined) {\n        try {\n          var tokenResponse = yield instance.acquireTokenSilent(_objectSpread(_objectSpread({}, loginRequest), {}, {\n            account: accounts[0]\n          }));\n          var secondResult = yield callMsGraph(tokenResponse.accessToken, url, instance, accounts, method, perfer, body, true);\n          return secondResult;\n        } catch (_unused) {\n          instance.logoutPopup({\n            postLogoutRedirectUri: \"/\",\n            mainWindowRedirectUri: \"/\"\n          });\n          return response;\n        }\n      } else {\n        return response;\n      }\n    } else {\n      return response;\n    }\n  });\n  return _callMsGraph.apply(this, arguments);\n}","map":{"version":3,"names":["loginRequest","callMsGraph","_x","_x2","_x3","_x4","_x5","_x6","_x7","_x8","_callMsGraph","apply","arguments","_asyncToGenerator","accessToken","url","instance","accounts","method","perfer","body","secondAuth","headers","Headers","bearer","append","options","response","fetch","status","undefined","tokenResponse","acquireTokenSilent","_objectSpread","account","secondResult","_unused","logoutPopup","postLogoutRedirectUri","mainWindowRedirectUri"],"sources":["/Users/andrewmainella/Desktop/Pauly/src/Functions/microsoftAssets.tsx"],"sourcesContent":["import { useMsal } from \"@azure/msal-react\";\nimport { loginRequest } from \"../authConfig\";\nimport { AccountInfo, IPublicClientApplication } from \"@azure/msal-browser\";\n\nexport default async function callMsGraph(accessToken: string, url: string, instance: IPublicClientApplication, accounts: AccountInfo[], method?: \"GET\" | \"POST\" | \"PATCH\" | \"DELETE\", perfer?: boolean, body?: string, secondAuth?: boolean): Promise<Response> {\n    const headers = new Headers();\n    const bearer = `Bearer ${accessToken}`;\n\n    headers.append(\"Authorization\", bearer);\n    headers.append(\"Content-Type\", \"application/json\")\n\n    if (perfer){\n        headers.append('Prefer','outlook.timezone=\"Central America Standard Time\"')\n    }\n\n    const options = {\n        method: (method) ? method:\"GET\",\n        headers: headers,\n        body: body\n    };\n\n    const response  = await fetch(url, options)\n    if (response.status === 401) {\n        if (secondAuth === undefined){\n            try{\n                const tokenResponse = await instance.acquireTokenSilent({\n                    ...loginRequest,\n                    account: accounts[0],\n                })\n                const secondResult = await callMsGraph(tokenResponse.accessToken, url, instance, accounts, method, perfer, body, true)\n                return secondResult\n            } catch {\n                instance.logoutPopup({\n                    postLogoutRedirectUri: \"/\",\n                    mainWindowRedirectUri: \"/\",\n                });\n                return response\n            }\n        } else {\n            return response\n        }\n    } else {\n        return response\n    }\n}"],"mappings":";;;;AACA,SAASA,YAAY;AAGrB,wBAA8BC,WAAWA,CAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;EAAA,OAAAC,YAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAwCxC,SAAAF,aAAA;EAAAA,YAAA,GAAAG,iBAAA,CAxCc,WAA2BC,WAAmB,EAAEC,GAAW,EAAEC,QAAkC,EAAEC,QAAuB,EAAEC,MAA4C,EAAEC,MAAgB,EAAEC,IAAa,EAAEC,UAAoB,EAAqB;IAC7P,IAAMC,OAAO,GAAG,IAAIC,OAAO,CAAC,CAAC;IAC7B,IAAMC,MAAM,GAAI,UAASV,WAAY,EAAC;IAEtCQ,OAAO,CAACG,MAAM,CAAC,eAAe,EAAED,MAAM,CAAC;IACvCF,OAAO,CAACG,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAElD,IAAIN,MAAM,EAAC;MACPG,OAAO,CAACG,MAAM,CAAC,QAAQ,EAAC,kDAAkD,CAAC;IAC/E;IAEA,IAAMC,OAAO,GAAG;MACZR,MAAM,EAAGA,MAAM,GAAIA,MAAM,GAAC,KAAK;MAC/BI,OAAO,EAAEA,OAAO;MAChBF,IAAI,EAAEA;IACV,CAAC;IAED,IAAMO,QAAQ,SAAUC,KAAK,CAACb,GAAG,EAAEW,OAAO,CAAC;IAC3C,IAAIC,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;MACzB,IAAIR,UAAU,KAAKS,SAAS,EAAC;QACzB,IAAG;UACC,IAAMC,aAAa,SAASf,QAAQ,CAACgB,kBAAkB,CAAAC,aAAA,CAAAA,aAAA,KAChDjC,YAAY;YACfkC,OAAO,EAAEjB,QAAQ,CAAC,CAAC;UAAC,EACvB,CAAC;UACF,IAAMkB,YAAY,SAASlC,WAAW,CAAC8B,aAAa,CAACjB,WAAW,EAAEC,GAAG,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,MAAM,EAAEC,IAAI,EAAE,IAAI,CAAC;UACtH,OAAOe,YAAY;QACvB,CAAC,CAAC,OAAAC,OAAA,EAAM;UACJpB,QAAQ,CAACqB,WAAW,CAAC;YACjBC,qBAAqB,EAAE,GAAG;YAC1BC,qBAAqB,EAAE;UAC3B,CAAC,CAAC;UACF,OAAOZ,QAAQ;QACnB;MACJ,CAAC,MAAM;QACH,OAAOA,QAAQ;MACnB;IACJ,CAAC,MAAM;MACH,OAAOA,QAAQ;IACnB;EACJ,CAAC;EAAA,OAAAjB,YAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}