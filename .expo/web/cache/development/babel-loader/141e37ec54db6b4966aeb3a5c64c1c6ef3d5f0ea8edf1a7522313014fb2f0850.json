{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { siteID } from \"../PaulyConfig\";\nimport store from \"../Redux/store\";\nimport callMsGraph from \"./microsoftAssets\";\nimport { loadingStateEnum } from \"../types\";\nexport default function getCurrentPaulyData(_x, _x2, _x3) {\n  return _getCurrentPaulyData.apply(this, arguments);\n}\nfunction _getCurrentPaulyData() {\n  _getCurrentPaulyData = _asyncToGenerator(function* (accessToken, instance, accounts) {\n    var result = yield callMsGraph(accessToken, \"https://graph.microsoft.com/v1.0/sites/\" + siteID + \"/lists/\" + store.getState().paulyList.paulyDataListId + \"/items/1/fields\", instance, accounts);\n    if (result.ok) {\n      var data = yield result.json();\n      console.log(data);\n      if (data[\"animationSpeed\"] !== undefined && data[\"message\"] !== undefined && data[\"powerpointId\"] !== undefined) {\n        return {\n          result: loadingStateEnum.success,\n          data: {\n            powerpointId: data[\"value\"][0][\"fields\"][\"powerpointId\"],\n            message: data[\"value\"][0][\"fields\"][\"message\"],\n            animationSpeed: data[\"value\"][0][\"fields\"][\"animationSpeed\"]\n          }\n        };\n      } else {\n        console.log(\"Herer\");\n        return {\n          result: loadingStateEnum.failed\n        };\n      }\n    } else {\n      return {\n        result: loadingStateEnum.failed\n      };\n    }\n  });\n  return _getCurrentPaulyData.apply(this, arguments);\n}","map":{"version":3,"names":["siteID","store","callMsGraph","loadingStateEnum","getCurrentPaulyData","_x","_x2","_x3","_getCurrentPaulyData","apply","arguments","_asyncToGenerator","accessToken","instance","accounts","result","getState","paulyList","paulyDataListId","ok","data","json","console","log","undefined","success","powerpointId","message","animationSpeed","failed"],"sources":["/Users/andrewmainella/Desktop/Pauly/src/Functions/getCurrentPaulyData.ts"],"sourcesContent":["import { AccountInfo, IPublicClientApplication } from \"@azure/msal-browser\"\nimport { siteID } from \"../PaulyConfig\"\nimport store from \"../Redux/store\"\nimport callMsGraph from \"./microsoftAssets\"\nimport { loadingStateEnum } from \"../types\"\n\nexport default async function getCurrentPaulyData(accessToken: string, instance: IPublicClientApplication, accounts: AccountInfo[]): Promise<{result: loadingStateEnum, data?: {powerpointId: string, message: string, animationSpeed: number}}> {\n    const result = await callMsGraph(accessToken, \"https://graph.microsoft.com/v1.0/sites/\" + siteID + \"/lists/\" + store.getState().paulyList.paulyDataListId + \"/items/1/fields\", instance, accounts)//TO DO fix list ids\n    if (result.ok){\n        const data = await result.json()\n        console.log(data)\n        if (data[\"animationSpeed\"] !== undefined && data[\"message\"] !== undefined && data[\"powerpointId\"] !== undefined) {\n            return {result: loadingStateEnum.success, data: {powerpointId: data[\"value\"][0][\"fields\"][\"powerpointId\"], message: data[\"value\"][0][\"fields\"][\"message\"], animationSpeed: data[\"value\"][0][\"fields\"][\"animationSpeed\"]}}\n        } else {\n            console.log(\"Herer\")\n            return {result: loadingStateEnum.failed}\n        }\n    } else {\n        return {result: loadingStateEnum.failed}\n    }\n}"],"mappings":";AACA,SAASA,MAAM;AACf,OAAOC,KAAK;AACZ,OAAOC,WAAW;AAClB,SAASC,gBAAgB;AAEzB,wBAA8BC,mBAAmBA,CAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA;EAAA,OAAAC,oBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAchD,SAAAF,qBAAA;EAAAA,oBAAA,GAAAG,iBAAA,CAdc,WAAmCC,WAAmB,EAAEC,QAAkC,EAAEC,QAAuB,EAA+G;IAC7O,IAAMC,MAAM,SAASb,WAAW,CAACU,WAAW,EAAE,yCAAyC,GAAGZ,MAAM,GAAG,SAAS,GAAGC,KAAK,CAACe,QAAQ,CAAC,CAAC,CAACC,SAAS,CAACC,eAAe,GAAG,iBAAiB,EAAEL,QAAQ,EAAEC,QAAQ,CAAC;IAClM,IAAIC,MAAM,CAACI,EAAE,EAAC;MACV,IAAMC,IAAI,SAASL,MAAM,CAACM,IAAI,CAAC,CAAC;MAChCC,OAAO,CAACC,GAAG,CAACH,IAAI,CAAC;MACjB,IAAIA,IAAI,CAAC,gBAAgB,CAAC,KAAKI,SAAS,IAAIJ,IAAI,CAAC,SAAS,CAAC,KAAKI,SAAS,IAAIJ,IAAI,CAAC,cAAc,CAAC,KAAKI,SAAS,EAAE;QAC7G,OAAO;UAACT,MAAM,EAAEZ,gBAAgB,CAACsB,OAAO;UAAEL,IAAI,EAAE;YAACM,YAAY,EAAEN,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,cAAc,CAAC;YAAEO,OAAO,EAAEP,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC;YAAEQ,cAAc,EAAER,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,gBAAgB;UAAC;QAAC,CAAC;MAC7N,CAAC,MAAM;QACHE,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;QACpB,OAAO;UAACR,MAAM,EAAEZ,gBAAgB,CAAC0B;QAAM,CAAC;MAC5C;IACJ,CAAC,MAAM;MACH,OAAO;QAACd,MAAM,EAAEZ,gBAAgB,CAAC0B;MAAM,CAAC;IAC5C;EACJ,CAAC;EAAA,OAAArB,oBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}