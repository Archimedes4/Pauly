{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport callMsGraph from \"./microsoftAssets\";\nvar dataContentTypeOptions = function (dataContentTypeOptions) {\n  dataContentTypeOptions[dataContentTypeOptions[\"video\"] = 0] = \"video\";\n  dataContentTypeOptions[dataContentTypeOptions[\"image\"] = 1] = \"image\";\n  dataContentTypeOptions[dataContentTypeOptions[\"unknown\"] = 2] = \"unknown\";\n  return dataContentTypeOptions;\n}(dataContentTypeOptions || {});\nexport default function getFileWithShareID(_x, _x2, _x3, _x4) {\n  return _getFileWithShareID.apply(this, arguments);\n}\nfunction _getFileWithShareID() {\n  _getFileWithShareID = _asyncToGenerator(function* (shareID, microsoftAccessToken, instance, accounts) {\n    var result = yield callMsGraph(microsoftAccessToken, \"https://graph.microsoft.com/v1.0/shares/\" + shareID + \"/driveItem\", instance, accounts);\n    console.log(result);\n    if (result.ok) {\n      var data = yield result.json();\n      console.log(data);\n      if (data[\"@microsoft.graph.downloadUrl\"] !== undefined && data[\"@microsoft.graph.downloadUrl\"] !== null) {\n        if (data[\"file\"][\"mimeType\"] === \"image/gif\") {\n          return {\n            url: data[\"@microsoft.graph.downloadUrl\"],\n            contentType: dataContentTypeOptions.image\n          };\n        } else if (data[\"file\"][\"mimeType\"] === \"video/mp4\") {\n          return {\n            url: data[\"@microsoft.graph.downloadUrl\"],\n            contentType: dataContentTypeOptions.video\n          };\n        } else {\n          throw \"Error\";\n        }\n      } else {\n        throw \"Error\";\n      }\n    } else {\n      throw \"Error\";\n    }\n  });\n  return _getFileWithShareID.apply(this, arguments);\n}","map":{"version":3,"names":["callMsGraph","dataContentTypeOptions","getFileWithShareID","_x","_x2","_x3","_x4","_getFileWithShareID","apply","arguments","_asyncToGenerator","shareID","microsoftAccessToken","instance","accounts","result","console","log","ok","data","json","undefined","url","contentType","image","video"],"sources":["/Users/andrewmainella/Desktop/Pauly/src/Functions/getFileWithShareID.tsx"],"sourcesContent":["import { AccountInfo, IPublicClientApplication } from \"@azure/msal-browser\";\nimport callMsGraph from \"./microsoftAssets\"\n\nenum dataContentTypeOptions {\n    video,\n    image,\n    unknown\n}\n\nexport default async function getFileWithShareID(shareID: string, microsoftAccessToken: string, instance: IPublicClientApplication, accounts: AccountInfo[]): Promise<{ url: string; contentType: dataContentTypeOptions }> {\n    const result = await callMsGraph(microsoftAccessToken, \"https://graph.microsoft.com/v1.0/shares/\" + shareID + \"/driveItem\", instance, accounts)\n    console.log(result)\n    if (result.ok){\n        const data = await result.json()\n        console.log(data)\n        if (data[\"@microsoft.graph.downloadUrl\"] !== undefined && data[\"@microsoft.graph.downloadUrl\"] !== null){\n            if (data[\"file\"][\"mimeType\"] === \"image/gif\") {\n                return {url: data[\"@microsoft.graph.downloadUrl\"], contentType: dataContentTypeOptions.image}\n            } else if (data[\"file\"][\"mimeType\"] === \"video/mp4\") {\n                return {url: data[\"@microsoft.graph.downloadUrl\"], contentType: dataContentTypeOptions.video}\n            } else {\n                throw \"Error\"\n            }\n        } else {\n            throw \"Error\"\n        }\n    } else {\n        throw \"Error\"\n    }\n}"],"mappings":";AACA,OAAOA,WAAW;AAAyB,IAEtCC,sBAAsB,aAAtBA,sBAAsB;EAAtBA,sBAAsB,CAAtBA,sBAAsB;EAAtBA,sBAAsB,CAAtBA,sBAAsB;EAAtBA,sBAAsB,CAAtBA,sBAAsB;EAAA,OAAtBA,sBAAsB;AAAA,EAAtBA,sBAAsB;AAM3B,wBAA8BC,kBAAkBA,CAAAC,EAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;EAAA,OAAAC,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAoB/C,SAAAF,oBAAA;EAAAA,mBAAA,GAAAG,iBAAA,CApBc,WAAkCC,OAAe,EAAEC,oBAA4B,EAAEC,QAAkC,EAAEC,QAAuB,EAAiE;IACxN,IAAMC,MAAM,SAASf,WAAW,CAACY,oBAAoB,EAAE,0CAA0C,GAAGD,OAAO,GAAG,YAAY,EAAEE,QAAQ,EAAEC,QAAQ,CAAC;IAC/IE,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC;IACnB,IAAIA,MAAM,CAACG,EAAE,EAAC;MACV,IAAMC,IAAI,SAASJ,MAAM,CAACK,IAAI,CAAC,CAAC;MAChCJ,OAAO,CAACC,GAAG,CAACE,IAAI,CAAC;MACjB,IAAIA,IAAI,CAAC,8BAA8B,CAAC,KAAKE,SAAS,IAAIF,IAAI,CAAC,8BAA8B,CAAC,KAAK,IAAI,EAAC;QACpG,IAAIA,IAAI,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC,KAAK,WAAW,EAAE;UAC1C,OAAO;YAACG,GAAG,EAAEH,IAAI,CAAC,8BAA8B,CAAC;YAAEI,WAAW,EAAEtB,sBAAsB,CAACuB;UAAK,CAAC;QACjG,CAAC,MAAM,IAAIL,IAAI,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC,KAAK,WAAW,EAAE;UACjD,OAAO;YAACG,GAAG,EAAEH,IAAI,CAAC,8BAA8B,CAAC;YAAEI,WAAW,EAAEtB,sBAAsB,CAACwB;UAAK,CAAC;QACjG,CAAC,MAAM;UACH,MAAM,OAAO;QACjB;MACJ,CAAC,MAAM;QACH,MAAM,OAAO;MACjB;IACJ,CAAC,MAAM;MACH,MAAM,OAAO;IACjB;EACJ,CAAC;EAAA,OAAAlB,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}